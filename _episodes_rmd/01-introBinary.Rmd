---
source: Rmd
title: "An introduction to binary response variables"
objectives:
  - "Calculate the probabilities of success and failure given binary data."
  - "Interpret the expectation of a binary variable."
  - "Calculate and interpret the odds of success given binary data."
  - "Calculate and interpret the log odds of success given binary data."
keypoints:
questions:
teaching: 10
execises: 10
---
```{r, include=FALSE}
source("../bin/chunk-options.R")
# source("../bin/obtain_data.R")
load("../bin/data.RData")
knitr_fig_path("01-")
library(dplyr)
library(tidyr)
```


```{r}
dat %>%
  drop_na(SmokeNow) %>%
  filter(Age == 60) %>%
  count(SmokeNow) %>%
  mutate(prop = n/sum(n))
```

> ## Exercise  
> You have been asked to study physical activity (`PhysActive`) 
> in individuals with an FEV1 (`FEV1`) between 3750 and 4250 in the NHANES data. 
> A) Estimate the probabilitites that someone is or is not physically active
> for individuals with an FEV1 between 3750 and 4250.   
> B) What value is $E(\text{PhysActive})$ for individuals 
> with an FEV1 between 3750 and 4250?
>
> > ## Solution
> > A) To obtain the probabilities:
> > 
> > ```{r probabilities PhysActive_FEV1}
> > dat %>%
> >   drop_na(PhysActive) %>%
> >   filter(between(FEV1, 3750, 4250)) %>%
> >   count(PhysActive) %>%
> >   mutate(prop = n/sum(n)) 
> > ```
> > 
> > We therefore estimate the probability of physical activity to be 0.61
> > and the probability of no physical activity to be 0.39.  
> > 
> > B) $E(\text{PhysActive}) = Pr(\text{PhysActive} = \text{Yes}) = 0.61$
> {: .solution}
{: .challenge}

```{r}
dat %>%
  drop_na(SmokeNow) %>%
  filter(between(Age, 55, 65)) %>%
  count(SmokeNow) %>%
  mutate(prop = n/sum(n)) %>%
  filter(SmokeNow == "Yes") %>%
  summarise(odds = prop/(1-prop),
    log_odds = log(prop/(1-prop)))
```

> ## Exercise  
> You have been asked to study physical activity (`PhysActive`) 
> in individuals with an FEV1 (`FEV1`) between 3750 and 4250 in the NHANES data. 
> Calculate the odds and the log odds of physical activity
> for individuals with an FEV1 between 3750 and 4250. 
> How is the odds interpreted here?
>
> > ## Solution
> > 
> > ```{r odds and log odds PhysActive_FEV1}
> > dat %>%
> >   drop_na(PhysActive) %>%
> >   filter(between(FEV1, 3750, 4250)) %>%
> >   count(PhysActive) %>%
> >   mutate(prop = n/sum(n)) %>%
> >   filter(PhysActive == "Yes") %>%
> >   summarise(odds = prop/(1-prop),
> >     log_odds = log(prop/(1-prop)))
> > ```
> > 
> > Since the odds equal 2.17, we expect individuals with an FEV1 between 3750
> > and 4250 to be 2.17 times more likely to be physically active than not. 
> {: .solution}
{: .challenge}


> ## What does $\text{log}()$ do?
> 
{: .callout}
